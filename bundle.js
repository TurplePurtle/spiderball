(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function restParam(r,t){if("function"!=typeof r)throw new TypeError(FUNC_ERROR_TEXT);return t=nativeMax(void 0===t?r.length-1:+t||0,0),function(){for(var a=arguments,e=-1,n=nativeMax(a.length-t,0),i=Array(n);++e<n;)i[e]=a[t+e];switch(t){case 0:return r.call(this,i);case 1:return r.call(this,a[0],i);case 2:return r.call(this,a[0],a[1],i)}var c=Array(t+1);for(e=-1;++e<t;)c[e]=a[e];return c[t]=i,r.apply(this,c)}}var FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max;module.exports=restParam;

},{}],2:[function(require,module,exports){
function assignWith(e,r,i){for(var s=-1,n=keys(r),t=n.length;++s<t;){var o=n[s],a=e[o],u=i(a,r[o],o,e,r);(u===u?u===a:a!==a)&&(void 0!==a||o in e)||(e[o]=u)}return e}var keys=require("../object/keys");module.exports=assignWith;

},{"../object/keys":22}],3:[function(require,module,exports){
function baseAssign(e,s){return null==s?e:baseCopy(s,keys(s),e)}var baseCopy=require("./baseCopy"),keys=require("../object/keys");module.exports=baseAssign;

},{"../object/keys":22,"./baseCopy":4}],4:[function(require,module,exports){
function baseCopy(e,o,r){r||(r={});for(var a=-1,n=o.length;++a<n;){var t=o[a];r[t]=e[t]}return r}module.exports=baseCopy;

},{}],5:[function(require,module,exports){
function baseProperty(r){return function(e){return null==e?void 0:e[r]}}module.exports=baseProperty;

},{}],6:[function(require,module,exports){
function bindCallback(n,t,r){if("function"!=typeof n)return identity;if(void 0===t)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)};case 5:return function(r,e,u,i,c){return n.call(t,r,e,u,i,c)}}return function(){return n.apply(t,arguments)}}var identity=require("../utility/identity");module.exports=bindCallback;

},{"../utility/identity":24}],7:[function(require,module,exports){
function createAssigner(e){return restParam(function(r,a){var t=-1,i=null==r?0:a.length,n=i>2?a[i-2]:void 0,l=i>2?a[2]:void 0,o=i>1?a[i-1]:void 0;for("function"==typeof n?(n=bindCallback(n,o,5),i-=2):(n="function"==typeof o?o:void 0,i-=n?1:0),l&&isIterateeCall(a[0],a[1],l)&&(n=3>i?void 0:n,i=1);++t<i;){var u=a[t];u&&e(r,u,n)}return r})}var bindCallback=require("./bindCallback"),isIterateeCall=require("./isIterateeCall"),restParam=require("../function/restParam");module.exports=createAssigner;

},{"../function/restParam":1,"./bindCallback":6,"./isIterateeCall":12}],8:[function(require,module,exports){
var baseProperty=require("./baseProperty"),getLength=baseProperty("length");module.exports=getLength;

},{"./baseProperty":5}],9:[function(require,module,exports){
function getNative(e,i){var t=null==e?void 0:e[i];return isNative(t)?t:void 0}var isNative=require("../lang/isNative");module.exports=getNative;

},{"../lang/isNative":19}],10:[function(require,module,exports){
function isArrayLike(e){return null!=e&&isLength(getLength(e))}var getLength=require("./getLength"),isLength=require("./isLength");module.exports=isArrayLike;

},{"./getLength":8,"./isLength":13}],11:[function(require,module,exports){
function isIndex(e,n){return e="number"==typeof e||reIsUint.test(e)?+e:-1,n=null==n?MAX_SAFE_INTEGER:n,e>-1&&e%1==0&&n>e}var reIsUint=/^\d+$/,MAX_SAFE_INTEGER=9007199254740991;module.exports=isIndex;

},{}],12:[function(require,module,exports){
function isIterateeCall(e,r,i){if(!isObject(i))return!1;var t=typeof r;if("number"==t?isArrayLike(i)&&isIndex(r,i.length):"string"==t&&r in i){var n=i[r];return e===e?e===n:n!==n}return!1}var isArrayLike=require("./isArrayLike"),isIndex=require("./isIndex"),isObject=require("../lang/isObject");module.exports=isIterateeCall;

},{"../lang/isObject":20,"./isArrayLike":10,"./isIndex":11}],13:[function(require,module,exports){
function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&MAX_SAFE_INTEGER>=e}var MAX_SAFE_INTEGER=9007199254740991;module.exports=isLength;

},{}],14:[function(require,module,exports){
function isObjectLike(e){return!!e&&"object"==typeof e}module.exports=isObjectLike;

},{}],15:[function(require,module,exports){
function shimKeys(e){for(var r=keysIn(e),s=r.length,n=s&&e.length,t=!!n&&isLength(n)&&(isArray(e)||isArguments(e)),i=-1,o=[];++i<s;){var a=r[i];(t&&isIndex(a,n)||hasOwnProperty.call(e,a))&&o.push(a)}return o}var isArguments=require("../lang/isArguments"),isArray=require("../lang/isArray"),isIndex=require("./isIndex"),isLength=require("./isLength"),keysIn=require("../object/keysIn"),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;module.exports=shimKeys;

},{"../lang/isArguments":16,"../lang/isArray":17,"../object/keysIn":23,"./isIndex":11,"./isLength":13}],16:[function(require,module,exports){
function isArguments(e){return isObjectLike(e)&&isArrayLike(e)&&hasOwnProperty.call(e,"callee")&&!propertyIsEnumerable.call(e,"callee")}var isArrayLike=require("../internal/isArrayLike"),isObjectLike=require("../internal/isObjectLike"),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,propertyIsEnumerable=objectProto.propertyIsEnumerable;module.exports=isArguments;

},{"../internal/isArrayLike":10,"../internal/isObjectLike":14}],17:[function(require,module,exports){
var getNative=require("../internal/getNative"),isLength=require("../internal/isLength"),isObjectLike=require("../internal/isObjectLike"),arrayTag="[object Array]",objectProto=Object.prototype,objToString=objectProto.toString,nativeIsArray=getNative(Array,"isArray"),isArray=nativeIsArray||function(r){return isObjectLike(r)&&isLength(r.length)&&objToString.call(r)==arrayTag};module.exports=isArray;

},{"../internal/getNative":9,"../internal/isLength":13,"../internal/isObjectLike":14}],18:[function(require,module,exports){
function isFunction(t){return isObject(t)&&objToString.call(t)==funcTag}var isObject=require("./isObject"),funcTag="[object Function]",objectProto=Object.prototype,objToString=objectProto.toString;module.exports=isFunction;

},{"./isObject":20}],19:[function(require,module,exports){
function isNative(t){return null==t?!1:isFunction(t)?reIsNative.test(fnToString.call(t)):isObjectLike(t)&&reIsHostCtor.test(t)}var isFunction=require("./isFunction"),isObjectLike=require("../internal/isObjectLike"),reIsHostCtor=/^\[object .+?Constructor\]$/,objectProto=Object.prototype,fnToString=Function.prototype.toString,hasOwnProperty=objectProto.hasOwnProperty,reIsNative=RegExp("^"+fnToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");module.exports=isNative;

},{"../internal/isObjectLike":14,"./isFunction":18}],20:[function(require,module,exports){
function isObject(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}module.exports=isObject;

},{}],21:[function(require,module,exports){
var assignWith=require("../internal/assignWith"),baseAssign=require("../internal/baseAssign"),createAssigner=require("../internal/createAssigner"),assign=createAssigner(function(s,e,i){return i?assignWith(s,e,i):baseAssign(s,e)});module.exports=assign;

},{"../internal/assignWith":2,"../internal/baseAssign":3,"../internal/createAssigner":7}],22:[function(require,module,exports){
var getNative=require("../internal/getNative"),isArrayLike=require("../internal/isArrayLike"),isObject=require("../lang/isObject"),shimKeys=require("../internal/shimKeys"),nativeKeys=getNative(Object,"keys"),keys=nativeKeys?function(e){var i=null==e?void 0:e.constructor;return"function"==typeof i&&i.prototype===e||"function"!=typeof e&&isArrayLike(e)?shimKeys(e):isObject(e)?nativeKeys(e):[]}:shimKeys;module.exports=keys;

},{"../internal/getNative":9,"../internal/isArrayLike":10,"../internal/shimKeys":15,"../lang/isObject":20}],23:[function(require,module,exports){
function keysIn(r){if(null==r)return[];isObject(r)||(r=Object(r));var e=r.length;e=e&&isLength(e)&&(isArray(r)||isArguments(r))&&e||0;for(var t=r.constructor,n=-1,s="function"==typeof t&&t.prototype===r,i=Array(e),o=e>0;++n<e;)i[n]=n+"";for(var a in r)o&&isIndex(a,e)||"constructor"==a&&(s||!hasOwnProperty.call(r,a))||i.push(a);return i}var isArguments=require("../lang/isArguments"),isArray=require("../lang/isArray"),isIndex=require("../internal/isIndex"),isLength=require("../internal/isLength"),isObject=require("../lang/isObject"),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;module.exports=keysIn;

},{"../internal/isIndex":11,"../internal/isLength":13,"../lang/isArguments":16,"../lang/isArray":17,"../lang/isObject":20}],24:[function(require,module,exports){
function identity(t){return t}module.exports=identity;

},{}],25:[function(require,module,exports){
"use strict";function CollisionBox(){this.x=-1,this.y=-1,this.w=2,this.h=2}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=CollisionBox;

},{}],26:[function(require,module,exports){
"use strict";function FallDeath(e){this.y=e,this.triggered=!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=FallDeath;

},{}],27:[function(require,module,exports){
"use strict";function Gravity(e){this.g=e}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Gravity;

},{}],28:[function(require,module,exports){
"use strict";function Platform(){}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Platform;

},{}],29:[function(require,module,exports){
"use strict";function PlatformStander(){this.grounded=!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=PlatformStander;

},{}],30:[function(require,module,exports){
"use strict";function Player(){}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Player;

},{}],31:[function(require,module,exports){
"use strict";function Position(){this.x=0,this.y=0,this.x_=0,this.y_=0}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Position;

},{}],32:[function(require,module,exports){
"use strict";function RenderBox(){this.fillStyle=null,this.x=-1,this.y=-1,this.w=2,this.h=2}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=RenderBox;

},{}],33:[function(require,module,exports){
"use strict";function Spider(){this.facing=1,this.webbing=!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Spider;

},{}],34:[function(require,module,exports){
"use strict";function Sprite(e){this.sprite=e,this.currentFrame=0}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Sprite;

},{}],35:[function(require,module,exports){
"use strict";function Velocity(){this.x=0,this.y=0}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Velocity;

},{}],36:[function(require,module,exports){
"use strict";function Web(){this.t=0,this.x=0,this.y=0,this.dx=0,this.dy=0,this.hit=!1,this.hitLength=0,this.rate=400,this.ttl=.5}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Web;

},{}],37:[function(require,module,exports){
"use strict";var _initCanvas2=require("./lib/initCanvas"),_initCanvas3=babelHelpers.interopRequireDefault(_initCanvas2),_input=require("./input"),_input2=babelHelpers.interopRequireDefault(_input),_Demo=require("./scenes/Demo"),_Demo2=babelHelpers.interopRequireDefault(_Demo),_textures=require("./textures"),_textures2=babelHelpers.interopRequireDefault(_textures),_initCanvas=(0,_initCanvas3["default"])("#stage","2d",800,600),context=_initCanvas.context;_input2["default"].addEventListeners(),_textures2["default"].then(function(e){var t=new _Demo2["default"]({canvasContext:context,input:_input2["default"],textures:e}).load().start(),i=function(e){document.hidden?t.stop():t.start()};window.addEventListener("visibilitychange",i)});

},{"./input":38,"./lib/initCanvas":43,"./scenes/Demo":44,"./textures":54}],38:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Input=require("./lib/Input"),_Input2=babelHelpers.interopRequireDefault(_Input);exports["default"]=new _Input2["default"]({keys:{" ":"action",W:"jump",A:"left",S:"down",D:"right","&":"jump","%":"left","(":"down","'":"right"},axesFromKeys:[{axis:"x",defaultValue:0,names:["left","right"],values:[-1,1]}],gamepad:{buttons:[0,"jump",2,"action",12,"up",13,"down",14,"left",15,"right"],axes:[0,"x",1,"y"]}});

},{"./lib/Input":39}],39:[function(require,module,exports){
"use strict";function Input(e){var t=this;if(!e)throw new Error("No config was given.");if(this.codeToName={},this.nameToValue={},this.axisToValue={},this.nameToAxisFromKeys={},this.justPressedInputs=[],this.gamepadConfig=e.gamepad,e.keys){var s=e.keys;for(var n in s){var o=n.toUpperCase().charCodeAt(0),i=s[n];this.codeToName[o]=i,this.nameToValue[i]=!1}}if(e.axesFromKeys)for(var a=e.axesFromKeys,r=0,u=a.length;u>r;r++){var p=a[r];this.axisToValue[p.axis]=p.defaultValue,this.nameToAxisFromKeys[p.names[0]]=p,this.nameToAxisFromKeys[p.names[1]]=p}this.listenersAttached=!1,this.keydown=function(e){t._onkeydown(e)},this.keyup=function(e){t._onkeyup(e)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Input,Input.prototype.isPressed=function(e){return this.nameToValue[e]},Input.prototype.justPressed=function(e){return this.justPressedInputs.indexOf(e)>=0},Input.prototype.getAxis=function(e){return this.axisToValue[e]},Input.prototype.clearJustPressed=function(){this.justPressedInputs.length=0},Input.prototype.updateAxisFromKey=function(e){var t=this.nameToAxisFromKeys[e];if(t){var s=t.names,n=t.values;this.axisToValue[t.axis]=this.nameToValue[s[0]]?n[0]:this.nameToValue[s[1]]?n[1]:t.defaultValue}},Input.prototype.updateFromGamepad=function(e,t){var s=this.gamepadConfig.buttons;if(s)for(var n=0,o=s.length;o>n;n+=2){var i=s[n+1],a=t?t.buttons[s[n]]:s[n],r=e.buttons[a].pressed;r&&!this.nameToValue[i]&&this.justPressedInputs.push(i),this.nameToValue[i]=r}var u=this.gamepadConfig.axes;if(u)for(var n=0,o=u.length;o>n;n+=2){var p=t?t.axes[u[n]]:u[n];this.axisToValue[u[n+1]]=e.axes[p]}},Input.prototype.afterUpdate=function(){this.clearJustPressed()},Input.prototype._onkeydown=function(e){var t=e.keyCode,s=this.codeToName[t];s&&(this.nameToValue[s]||this.justPressedInputs.push(s),this.nameToValue[s]=!0,this.updateAxisFromKey(s))},Input.prototype._onkeyup=function(e){var t=e.keyCode,s=this.codeToName[t];s&&(this.nameToValue[s]=!1,this.updateAxisFromKey(s))},Input.prototype.addEventListeners=function(){return this.listenersAttached||(this.listenersAttached=!0,window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup)),this},Input.prototype.removeEventListeners=function(){return this.listenersAttached&&(this.listenersAttached=!1,window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup)),this};

},{}],40:[function(require,module,exports){
"use strict";function Loop(t,o,n){this.fn=t,this.thisArg=n,this.t0=0,this.running=!1,this.opts=o,this._loop=null,this.opts.useRAF||this.opts.interval||(this.opts.interval=1e3/60)}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Loop,Loop.prototype.start=function(){var t=this;if(!this.running)return this.running=!0,this.opts.useRAF?(this._loop=function(o){t.running&&(t.fn.call(t.thisArg,.001*(o-t.t0)),t.t0=o,window.requestAnimationFrame(t._loop))},window.requestAnimationFrame(function(o){t.t0=o,window.requestAnimationFrame(t._loop)})):(this._loop=function(){var o=Date.now();t.running&&(t.fn.call(t.thisArg,.001*(o-t.t0)),t.t0=o,window.setTimeout(t._loop,t.opts.interval))},this.t0=Date.now()-this.opts.interval,this._loop()),this},Loop.prototype.stop=function(){return this.running=!1,this},Loop.start=function(t,o,n){return new Loop(t,o,n).start()};

},{}],41:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ComponentMap=function(){function e(){babelHelpers.classCallCheck(this,e),this.entities=[],this.byId={}}return babelHelpers.createClass(e,[{key:"getComponent",value:function(e){return this.byId[e.id]}},{key:"setComponent",value:function(e,t){this.byId[e.id]||this.entities.push(e),this.byId[e.id]=t}},{key:"deleteComponent",value:function(e){delete this.byId[e.id];for(var t=this.entities,n=-1,i=0,o=t.length;o>i;i++)if(t[i]===e){n=i;break}-1!==n&&(n+1===t.length?t.pop():t[n]=t.pop())}}]),e}(),Entity=function(){function e(t,n){babelHelpers.classCallCheck(this,e),this.id=t,this.entityService=n}return babelHelpers.createClass(e,[{key:"getComponent",value:function(e){return this.entityService.getComponent(this,e)}},{key:"setComponent",value:function(e,t){this.entityService.setComponent(this,e,t)}},{key:"deleteComponent",value:function(e){return this.entityService.deleteComponent(this,e)}},{key:"destroy",value:function(){this.entityService.deleteEntity(this)}}]),e}(),EntityService=exports.EntityService=function(){function e(){babelHelpers.classCallCheck(this,e),this.entityCounter=0,this.componentMaps={}}return babelHelpers.createClass(e,[{key:"registerComponent",value:function(e){var t=e.name;this.componentMaps[t]||(this.componentMaps[t]=new ComponentMap)}},{key:"createEntity",value:function(){return this.entityCounter+=1,new Entity(this.entityCounter,this)}},{key:"deleteEntity",value:function(e){for(var t in this.componentMaps){var n=this.componentMaps[t];n.getComponent(e)&&n.deleteComponent(e)}}},{key:"getComponentMap",value:function(e){return this.componentMaps[e.name].entities}},{key:"getComponent",value:function(e,t){return this.componentMaps[t.name].getComponent(e)}},{key:"setComponent",value:function(e,t,n){var i=t.name;this.componentMaps[i].setComponent(e,n)}},{key:"deleteComponent",value:function(e,t){var n=t.name;this.componentMaps[n].deleteComponent(e)}}]),e}();

},{}],42:[function(require,module,exports){
"use strict";function mappingForGamepad(a){return""===a.mapping&&a.id.indexOf("Xbox One")>=0?mappings.XBOXONE.standard:null}Object.defineProperty(exports,"__esModule",{value:!0}),exports.mappingForGamepad=mappingForGamepad;var mappings={XBOXONE:{standard:{buttons:[11,12,13,14,8,9,-1,-1,5,4,6,7,0,1,2,3,10],axes:[0,1,3,4]}}};

},{}],43:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=function(e,t,n,o){var a=document.querySelector(e),d=document.createElement("canvas"),i=d.getContext(t);return d.width=n,d.height=o,i.mozImageSmoothingEnabled=!1,i.webkitImageSmoothingEnabled=!1,i.imageSmoothingEnabled=!1,a.appendChild(d),{canvas:d,context:i}};

},{}],44:[function(require,module,exports){
"use strict";function Demo(e){this.canvasContext=e.canvasContext,this.input=e.input,this.textures=e.textures,this.loop=new _Loop2["default"](this.tick,{useRAF:!0},this),this.running=!1,this.entityService=null,this.player=null,this.dt=0,this.updateSystems=[new _PlayerSpiderControlSystem2["default"],new _GravitySystem2["default"],new _VelocitySystem2["default"],new _SpiderWebSystem2["default"],new _PlatformSystem2["default"]],this.renderSystems=[new _ClearScreenSystem2["default"],new _SpiderWebRenderSystem2["default"],new _RenderBoxSystem2["default"],new _SpriteRenderSystem2["default"]]}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Demo;var _assign=require("lodash/object/assign"),_assign2=babelHelpers.interopRequireDefault(_assign),_Loop=require("../lib/Loop"),_Loop2=babelHelpers.interopRequireDefault(_Loop),_ezs=require("../lib/ezs"),_gamepadMapper=require("../lib/gamepad-mapper"),_Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Velocity=require("../components/Velocity"),_Velocity2=babelHelpers.interopRequireDefault(_Velocity),_Gravity=require("../components/Gravity"),_Gravity2=babelHelpers.interopRequireDefault(_Gravity),_CollisionBox=require("../components/CollisionBox"),_CollisionBox2=babelHelpers.interopRequireDefault(_CollisionBox),_RenderBox=require("../components/RenderBox"),_RenderBox2=babelHelpers.interopRequireDefault(_RenderBox),_Platform=require("../components/Platform"),_Platform2=babelHelpers.interopRequireDefault(_Platform),_PlatformStander=require("../components/PlatformStander"),_PlatformStander2=babelHelpers.interopRequireDefault(_PlatformStander),_Player=require("../components/Player"),_Player2=babelHelpers.interopRequireDefault(_Player),_FallDeath=require("../components/FallDeath"),_FallDeath2=babelHelpers.interopRequireDefault(_FallDeath),_Spider=require("../components/Spider"),_Spider2=babelHelpers.interopRequireDefault(_Spider),_Web=require("../components/Web"),_Web2=babelHelpers.interopRequireDefault(_Web),_Sprite=require("../components/Sprite"),_Sprite2=babelHelpers.interopRequireDefault(_Sprite),_PlayerSpiderControlSystem=require("../systems/PlayerSpiderControlSystem"),_PlayerSpiderControlSystem2=babelHelpers.interopRequireDefault(_PlayerSpiderControlSystem),_GravitySystem=require("../systems/GravitySystem"),_GravitySystem2=babelHelpers.interopRequireDefault(_GravitySystem),_VelocitySystem=require("../systems/VelocitySystem"),_VelocitySystem2=babelHelpers.interopRequireDefault(_VelocitySystem),_ClearScreenSystem=require("../systems/ClearScreenSystem"),_ClearScreenSystem2=babelHelpers.interopRequireDefault(_ClearScreenSystem),_RenderBoxSystem=require("../systems/RenderBoxSystem"),_RenderBoxSystem2=babelHelpers.interopRequireDefault(_RenderBoxSystem),_PlatformSystem=require("../systems/PlatformSystem"),_PlatformSystem2=babelHelpers.interopRequireDefault(_PlatformSystem),_SpiderWebSystem=require("../systems/SpiderWebSystem"),_SpiderWebSystem2=babelHelpers.interopRequireDefault(_SpiderWebSystem),_SpiderWebRenderSystem=require("../systems/SpiderWebRenderSystem"),_SpiderWebRenderSystem2=babelHelpers.interopRequireDefault(_SpiderWebRenderSystem),_SpriteRenderSystem=require("../systems/SpriteRenderSystem"),_SpriteRenderSystem2=babelHelpers.interopRequireDefault(_SpriteRenderSystem);Demo.prototype.load=function(){var e=this;this.entityService=new _ezs.EntityService,this.entityService.registerComponent(_Position2["default"]),this.entityService.registerComponent(_Velocity2["default"]),this.entityService.registerComponent(_Gravity2["default"]),this.entityService.registerComponent(_CollisionBox2["default"]),this.entityService.registerComponent(_RenderBox2["default"]),this.entityService.registerComponent(_Platform2["default"]),this.entityService.registerComponent(_PlatformStander2["default"]),this.entityService.registerComponent(_Player2["default"]),this.entityService.registerComponent(_FallDeath2["default"]),this.entityService.registerComponent(_Spider2["default"]),this.entityService.registerComponent(_Web2["default"]),this.entityService.registerComponent(_Sprite2["default"]);var t=this.entityService.createEntity();t.setComponent(_Position2["default"],(0,_assign2["default"])(new _Position2["default"],{x:150,y:250})),t.setComponent(_Velocity2["default"],(0,_assign2["default"])(new _Velocity2["default"],{x:1e3})),t.setComponent(_Gravity2["default"],new _Gravity2["default"](300)),t.setComponent(_CollisionBox2["default"],(0,_assign2["default"])(new _CollisionBox2["default"],{x:-8,y:-8,w:16,h:16})),t.setComponent(_PlatformStander2["default"],new _PlatformStander2["default"]),t.setComponent(_Player2["default"],new _Player2["default"]),t.setComponent(_FallDeath2["default"],new _FallDeath2["default"](this.canvasContext.canvas.height)),t.setComponent(_Spider2["default"],new _Spider2["default"]),t.setComponent(_Web2["default"],new _Web2["default"]),t.setComponent(_Sprite2["default"],new _Sprite2["default"](this.textures.spider)),this.player=t;var r=this.canvasContext.createPattern(this.textures.platform.image,"repeat");return[{x:50,y:400,vx:50},{x:150,y:450},{x:250,y:400},{x:350,y:350},{x:550,y:350},{x:650,y:300},{x:700,y:250},{x:650,y:200},{x:425,y:100,w:80},{x:300,y:200,w:100}].forEach(function(t){var i=t.w||50,n=t.h||8,o=new _Position2["default"];o.x=t.x,o.y=t.y;var s=new _CollisionBox2["default"],a=new _RenderBox2["default"];a.fillStyle=r,s.x=a.x=-i/2,s.y=a.y=-n/2,s.w=a.w=i,s.h=a.h=n;var l=new _Platform2["default"],p=e.entityService.createEntity();p.setComponent(_Position2["default"],o),p.setComponent(_CollisionBox2["default"],s),p.setComponent(_RenderBox2["default"],a),p.setComponent(_Platform2["default"],l)}),this},Demo.prototype.tick=function(e){this.dt=Math.min(e,.04);var t=this.updateSystems,r=this.renderSystems;if(this.player.getComponent(_FallDeath2["default"]).triggered)return void this.load();var i=navigator.getGamepads&&navigator.getGamepads()[0];i&&this.input.updateFromGamepad(i,(0,_gamepadMapper.mappingForGamepad)(i));for(var n=0,o=t.length;o>n;n++)t[n].run(this);this.input.afterUpdate();for(var n=0,o=r.length;o>n;n++)r[n].run(this)},Demo.prototype.start=function(){return this.running?void 0:(this.running=!0,this.loop.start(),this)},Demo.prototype.stop=function(){return this.running?(this.running=!1,this.loop.stop(),this):void 0},Demo.prototype.unload=function(){return this.stop(),this.loop=null,this};

},{"../components/CollisionBox":25,"../components/FallDeath":26,"../components/Gravity":27,"../components/Platform":28,"../components/PlatformStander":29,"../components/Player":30,"../components/Position":31,"../components/RenderBox":32,"../components/Spider":33,"../components/Sprite":34,"../components/Velocity":35,"../components/Web":36,"../lib/Loop":40,"../lib/ezs":41,"../lib/gamepad-mapper":42,"../systems/ClearScreenSystem":45,"../systems/GravitySystem":46,"../systems/PlatformSystem":47,"../systems/PlayerSpiderControlSystem":48,"../systems/RenderBoxSystem":49,"../systems/SpiderWebRenderSystem":50,"../systems/SpiderWebSystem":51,"../systems/SpriteRenderSystem":52,"../systems/VelocitySystem":53,"lodash/object/assign":21}],45:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ClearScreenSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){var a=e.canvasContext;a.clearRect(0,0,a.canvas.width,a.canvas.height)}}]),e}();exports["default"]=ClearScreenSystem;

},{}],46:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Gravity=require("../components/Gravity"),_Gravity2=babelHelpers.interopRequireDefault(_Gravity),_Velocity=require("../components/Velocity"),_Velocity2=babelHelpers.interopRequireDefault(_Velocity),GravitySystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){for(var t=e.dt,r=e.entityService.getComponentMap(_Gravity2["default"]),a=0,i=r.length;i>a;a++){var l=r[a],o=l.getComponent(_Velocity2["default"]),n=l.getComponent(_Gravity2["default"]);o.y+=n.g*t}}}]),e}();exports["default"]=GravitySystem;

},{"../components/Gravity":27,"../components/Velocity":35}],47:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Velocity=require("../components/Velocity"),_Velocity2=babelHelpers.interopRequireDefault(_Velocity),_CollisionBox=require("../components/CollisionBox"),_CollisionBox2=babelHelpers.interopRequireDefault(_CollisionBox),_Platform=require("../components/Platform"),_Platform2=babelHelpers.interopRequireDefault(_Platform),_PlatformStander=require("../components/PlatformStander"),_PlatformStander2=babelHelpers.interopRequireDefault(_PlatformStander),PlatformSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){for(var t=e.entityService.getComponentMap(_Platform2["default"]),o=e.entityService.getComponentMap(_PlatformStander2["default"]),l=0,n=o.length;n>l;l++){for(var r=o[l],i=r.getComponent(_CollisionBox2["default"]),a=r.getComponent(_Position2["default"]),s=r.getComponent(_Velocity2["default"]),u=r.getComponent(_PlatformStander2["default"]),f=!1,p=0,m=t.length;m>p;p++){var y=t[p],_=y.getComponent(_CollisionBox2["default"]),c=y.getComponent(_Position2["default"]),d=y.getComponent(_Velocity2["default"]);a.x+i.x+i.w>c.x+_.x&&a.x+i.x<c.x+_.x+_.w&&a.y+i.y+i.h>c.y+_.y&&a.y+i.y<c.y+_.y+_.h&&a.y_+i.y+i.h<=c.y+_.y&&(f=!0,a.y=c.y+_.y-i.y-i.h,s.y=0,d&&(s.x+=d.x))}u.grounded=f}}}]),e}();exports["default"]=PlatformSystem;

},{"../components/CollisionBox":25,"../components/Platform":28,"../components/PlatformStander":29,"../components/Position":31,"../components/Velocity":35}],48:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Player=require("../components/Player"),_Player2=babelHelpers.interopRequireDefault(_Player),_Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Velocity=require("../components/Velocity"),_Velocity2=babelHelpers.interopRequireDefault(_Velocity),_FallDeath=require("../components/FallDeath"),_FallDeath2=babelHelpers.interopRequireDefault(_FallDeath),_Spider=require("../components/Spider"),_Spider2=babelHelpers.interopRequireDefault(_Spider),_Web=require("../components/Web"),_Web2=babelHelpers.interopRequireDefault(_Web),_PlatformStander=require("../components/PlatformStander"),_PlatformStander2=babelHelpers.interopRequireDefault(_PlatformStander),PlayerSpiderControlSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){var t=e.dt,r=e.entityService.getComponentMap(_Player2["default"])[0],a=e.input,l=r.getComponent(_Position2["default"]),n=r.getComponent(_Velocity2["default"]),o=r.getComponent(_FallDeath2["default"]),i=r.getComponent(_Spider2["default"]),s=r.getComponent(_Web2["default"]),u=r.getComponent(_PlatformStander2["default"]).grounded,p=a.getAxis("x"),b=.1;if(i.webbing&&s.hit)(u||a.justPressed("jump")||a.justPressed("action"))&&(i.webbing=!1);else{var d=u?2e3:1500,_=u?15:2,f=150*p;u&&a.justPressed("jump")&&(n.y=-200),-b>p?(n.x>f&&(n.x=Math.max(n.x-d*t,f)),i.facing=-1):p>b?(n.x<f&&(n.x=Math.min(n.x+d*t,f)),i.facing=1):n.x*=Math.max(1-_*t,0),!i.webbing&&a.justPressed("action")&&(i.webbing=!0,s.t=0,s.x=l.x,s.y=l.y,s.dx=i.facing*Math.sqrt(.5),s.dy=-Math.sqrt(.5),s.hit=!1)}l.y>o.y&&(o.triggered=!0,i.webbing=!1)}}]),e}();exports["default"]=PlayerSpiderControlSystem;

},{"../components/FallDeath":26,"../components/PlatformStander":29,"../components/Player":30,"../components/Position":31,"../components/Spider":33,"../components/Velocity":35,"../components/Web":36}],49:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_RenderBox=require("../components/RenderBox"),_RenderBox2=babelHelpers.interopRequireDefault(_RenderBox),RenderBoxSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){for(var t=e.canvasContext,o=e.entityService.getComponentMap(_RenderBox2["default"]),n=0,r=o.length;r>n;n++){var l=o[n],i=l.getComponent(_Position2["default"]),s=l.getComponent(_RenderBox2["default"]);t.save(),t.fillStyle=s.fillStyle||"#fff";var a=i.x+s.x|0,u=i.y+s.y|0;t.translate(a,u),t.fillRect(0,0,s.w,s.h),t.restore()}}}]),e}();exports["default"]=RenderBoxSystem;

},{"../components/Position":31,"../components/RenderBox":32}],50:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Spider=require("../components/Spider"),_Spider2=babelHelpers.interopRequireDefault(_Spider),_Web=require("../components/Web"),_Web2=babelHelpers.interopRequireDefault(_Web),SpiderWebSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){var t=e.canvasContext,r=e.entityService.getComponentMap(_Web2["default"]);t.strokeStyle="#fff",t.lineWidth=2;for(var o=0,i=r.length;i>o;o++){var n=r[o],l=n.getComponent(_Spider2["default"]),a=n.getComponent(_Position2["default"]);if(l.webbing){var s=n.getComponent(_Web2["default"]);t.beginPath(),t.moveTo(a.x,a.y),t.lineTo(s.x,s.y),t.stroke()}}}}]),e}();exports["default"]=SpiderWebSystem;

},{"../components/Position":31,"../components/Spider":33,"../components/Web":36}],51:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Velocity=require("../components/Velocity"),_Velocity2=babelHelpers.interopRequireDefault(_Velocity),_Spider=require("../components/Spider"),_Spider2=babelHelpers.interopRequireDefault(_Spider),_Web=require("../components/Web"),_Web2=babelHelpers.interopRequireDefault(_Web),_Platform=require("../components/Platform"),_Platform2=babelHelpers.interopRequireDefault(_Platform),_CollisionBox=require("../components/CollisionBox"),_CollisionBox2=babelHelpers.interopRequireDefault(_CollisionBox),SpiderWebSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){for(var t=e.dt,o=e.entityService.getComponentMap(_Web2["default"]),i=0,r=o.length;r>i;i++){var l=o[i],n=l.getComponent(_Spider2["default"]),a=l.getComponent(_Position2["default"]);if(n.webbing){var s=l.getComponent(_Web2["default"]),p=l.getComponent(_Velocity2["default"]);if(s.hit){var u=a.x-s.x,b=a.y-s.y,f=s.hitLength,_=-b/f,y=u/f,x=_*p.x+y*p.y,c=x*t,d=u+_*c,m=b+y*c,C=f/Math.sqrt(d*d+m*m),g=s.x+d*C,q=s.y+m*C;p.x=(g-a.x)/t,p.y=(q-a.y)/t}else if(s.t>s.ttl)n.webbing=!1;else{s.x+=s.dx*s.rate*t,s.y+=s.dy*s.rate*t,s.t+=t;for(var h=e.entityService.getComponentMap(_Platform2["default"]),v=0,P=h.length;P>v;v++){var S=h[v],H=S.getComponent(_Position2["default"]),W=S.getComponent(_CollisionBox2["default"]);if(s.x>H.x+W.x&&s.x<H.x+W.x+W.w&&s.y>H.y+W.y&&s.y<H.y+W.y+W.h){var u=a.x-s.x,b=a.y-s.y;s.hitLength=Math.sqrt(u*u+b*b),s.hit=!0;break}}}}}}}]),e}();exports["default"]=SpiderWebSystem;

},{"../components/CollisionBox":25,"../components/Platform":28,"../components/Position":31,"../components/Spider":33,"../components/Velocity":35,"../components/Web":36}],52:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Sprite=require("../components/Sprite"),_Sprite2=babelHelpers.interopRequireDefault(_Sprite),SpriteRenderSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){for(var t=e.canvasContext,r=e.dt,i=e.entityService.getComponentMap(_Sprite2["default"]),n=0,a=i.length;a>n;n++){var o=i[n],s=o.getComponent(_Position2["default"]),p=o.getComponent(_Sprite2["default"]),u=p.sprite;if(u.image){var l=u.frameWidth,m=u.frameHeight,c=0;u.numFrames>1&&(c=(0|p.currentFrame)*l,p.currentFrame=(p.currentFrame+u.fps*r)%u.numFrames);var f=u.scale,d=s.x-.5*f*l|0,S=s.y-.5*f*m|0;t.drawImage(u.image,c,0,l,m,d,S,f*l,f*m)}}}}]),e}();exports["default"]=SpriteRenderSystem;

},{"../components/Position":31,"../components/Sprite":34}],53:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Velocity=require("../components/Velocity"),_Velocity2=babelHelpers.interopRequireDefault(_Velocity),VelocitySystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){for(var t=e.dt,o=e.entityService.getComponentMap(_Velocity2["default"]),i=0,l=o.length;l>i;i++){var n=o[i],r=n.getComponent(_Position2["default"]),s=n.getComponent(_Velocity2["default"]);r.x_=r.x,r.y_=r.y,r.x+=s.x*t,r.y+=s.y*t}}}]),e}();exports["default"]=VelocitySystem;

},{"../components/Position":31,"../components/Velocity":35}],54:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var textures={spider:{image:null,src:"sprites/spider.png",frameWidth:16,frameHeight:16,scale:1,numFrames:0,fps:8},platform:{image:null,src:"sprites/platform.png",frameWidth:8,frameHeight:8,scale:1,numFrames:0,fps:0}},texturesLoaded=Object.keys(textures).map(function(e){return new Promise(function(r,t){var s=textures[e],a=new Image;a.onload=function(e){s.image=a,s.numFrames||(s.numFrames=a.width/s.frameWidth),r(a)},a.src=s.src})}),allTexturesLoaded=Promise.all(texturesLoaded).then(function(e){return textures});exports["default"]=allTexturesLoaded;

},{}]},{},[37]);

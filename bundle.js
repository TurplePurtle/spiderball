(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function restParam(r,t){if("function"!=typeof r)throw new TypeError(FUNC_ERROR_TEXT);return t=nativeMax(void 0===t?r.length-1:+t||0,0),function(){for(var a=arguments,e=-1,n=nativeMax(a.length-t,0),i=Array(n);++e<n;)i[e]=a[t+e];switch(t){case 0:return r.call(this,i);case 1:return r.call(this,a[0],i);case 2:return r.call(this,a[0],a[1],i)}var c=Array(t+1);for(e=-1;++e<t;)c[e]=a[e];return c[t]=i,r.apply(this,c)}}var FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max;module.exports=restParam;

},{}],2:[function(require,module,exports){
function assignWith(e,r,i){for(var s=-1,n=keys(r),t=n.length;++s<t;){var o=n[s],a=e[o],u=i(a,r[o],o,e,r);(u===u?u===a:a!==a)&&(void 0!==a||o in e)||(e[o]=u)}return e}var keys=require("../object/keys");module.exports=assignWith;

},{"../object/keys":22}],3:[function(require,module,exports){
function baseAssign(e,s){return null==s?e:baseCopy(s,keys(s),e)}var baseCopy=require("./baseCopy"),keys=require("../object/keys");module.exports=baseAssign;

},{"../object/keys":22,"./baseCopy":4}],4:[function(require,module,exports){
function baseCopy(e,o,r){r||(r={});for(var a=-1,n=o.length;++a<n;){var t=o[a];r[t]=e[t]}return r}module.exports=baseCopy;

},{}],5:[function(require,module,exports){
function baseProperty(r){return function(e){return null==e?void 0:e[r]}}module.exports=baseProperty;

},{}],6:[function(require,module,exports){
function bindCallback(n,t,r){if("function"!=typeof n)return identity;if(void 0===t)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)};case 5:return function(r,e,u,i,c){return n.call(t,r,e,u,i,c)}}return function(){return n.apply(t,arguments)}}var identity=require("../utility/identity");module.exports=bindCallback;

},{"../utility/identity":24}],7:[function(require,module,exports){
function createAssigner(e){return restParam(function(r,a){var t=-1,i=null==r?0:a.length,n=i>2?a[i-2]:void 0,l=i>2?a[2]:void 0,o=i>1?a[i-1]:void 0;for("function"==typeof n?(n=bindCallback(n,o,5),i-=2):(n="function"==typeof o?o:void 0,i-=n?1:0),l&&isIterateeCall(a[0],a[1],l)&&(n=3>i?void 0:n,i=1);++t<i;){var u=a[t];u&&e(r,u,n)}return r})}var bindCallback=require("./bindCallback"),isIterateeCall=require("./isIterateeCall"),restParam=require("../function/restParam");module.exports=createAssigner;

},{"../function/restParam":1,"./bindCallback":6,"./isIterateeCall":12}],8:[function(require,module,exports){
var baseProperty=require("./baseProperty"),getLength=baseProperty("length");module.exports=getLength;

},{"./baseProperty":5}],9:[function(require,module,exports){
function getNative(e,i){var t=null==e?void 0:e[i];return isNative(t)?t:void 0}var isNative=require("../lang/isNative");module.exports=getNative;

},{"../lang/isNative":19}],10:[function(require,module,exports){
function isArrayLike(e){return null!=e&&isLength(getLength(e))}var getLength=require("./getLength"),isLength=require("./isLength");module.exports=isArrayLike;

},{"./getLength":8,"./isLength":13}],11:[function(require,module,exports){
function isIndex(e,n){return e="number"==typeof e||reIsUint.test(e)?+e:-1,n=null==n?MAX_SAFE_INTEGER:n,e>-1&&e%1==0&&n>e}var reIsUint=/^\d+$/,MAX_SAFE_INTEGER=9007199254740991;module.exports=isIndex;

},{}],12:[function(require,module,exports){
function isIterateeCall(e,r,i){if(!isObject(i))return!1;var t=typeof r;if("number"==t?isArrayLike(i)&&isIndex(r,i.length):"string"==t&&r in i){var n=i[r];return e===e?e===n:n!==n}return!1}var isArrayLike=require("./isArrayLike"),isIndex=require("./isIndex"),isObject=require("../lang/isObject");module.exports=isIterateeCall;

},{"../lang/isObject":20,"./isArrayLike":10,"./isIndex":11}],13:[function(require,module,exports){
function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&MAX_SAFE_INTEGER>=e}var MAX_SAFE_INTEGER=9007199254740991;module.exports=isLength;

},{}],14:[function(require,module,exports){
function isObjectLike(e){return!!e&&"object"==typeof e}module.exports=isObjectLike;

},{}],15:[function(require,module,exports){
function shimKeys(e){for(var r=keysIn(e),s=r.length,n=s&&e.length,t=!!n&&isLength(n)&&(isArray(e)||isArguments(e)),i=-1,o=[];++i<s;){var a=r[i];(t&&isIndex(a,n)||hasOwnProperty.call(e,a))&&o.push(a)}return o}var isArguments=require("../lang/isArguments"),isArray=require("../lang/isArray"),isIndex=require("./isIndex"),isLength=require("./isLength"),keysIn=require("../object/keysIn"),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;module.exports=shimKeys;

},{"../lang/isArguments":16,"../lang/isArray":17,"../object/keysIn":23,"./isIndex":11,"./isLength":13}],16:[function(require,module,exports){
function isArguments(e){return isObjectLike(e)&&isArrayLike(e)&&hasOwnProperty.call(e,"callee")&&!propertyIsEnumerable.call(e,"callee")}var isArrayLike=require("../internal/isArrayLike"),isObjectLike=require("../internal/isObjectLike"),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,propertyIsEnumerable=objectProto.propertyIsEnumerable;module.exports=isArguments;

},{"../internal/isArrayLike":10,"../internal/isObjectLike":14}],17:[function(require,module,exports){
var getNative=require("../internal/getNative"),isLength=require("../internal/isLength"),isObjectLike=require("../internal/isObjectLike"),arrayTag="[object Array]",objectProto=Object.prototype,objToString=objectProto.toString,nativeIsArray=getNative(Array,"isArray"),isArray=nativeIsArray||function(r){return isObjectLike(r)&&isLength(r.length)&&objToString.call(r)==arrayTag};module.exports=isArray;

},{"../internal/getNative":9,"../internal/isLength":13,"../internal/isObjectLike":14}],18:[function(require,module,exports){
function isFunction(t){return isObject(t)&&objToString.call(t)==funcTag}var isObject=require("./isObject"),funcTag="[object Function]",objectProto=Object.prototype,objToString=objectProto.toString;module.exports=isFunction;

},{"./isObject":20}],19:[function(require,module,exports){
function isNative(t){return null==t?!1:isFunction(t)?reIsNative.test(fnToString.call(t)):isObjectLike(t)&&reIsHostCtor.test(t)}var isFunction=require("./isFunction"),isObjectLike=require("../internal/isObjectLike"),reIsHostCtor=/^\[object .+?Constructor\]$/,objectProto=Object.prototype,fnToString=Function.prototype.toString,hasOwnProperty=objectProto.hasOwnProperty,reIsNative=RegExp("^"+fnToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");module.exports=isNative;

},{"../internal/isObjectLike":14,"./isFunction":18}],20:[function(require,module,exports){
function isObject(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}module.exports=isObject;

},{}],21:[function(require,module,exports){
var assignWith=require("../internal/assignWith"),baseAssign=require("../internal/baseAssign"),createAssigner=require("../internal/createAssigner"),assign=createAssigner(function(s,e,i){return i?assignWith(s,e,i):baseAssign(s,e)});module.exports=assign;

},{"../internal/assignWith":2,"../internal/baseAssign":3,"../internal/createAssigner":7}],22:[function(require,module,exports){
var getNative=require("../internal/getNative"),isArrayLike=require("../internal/isArrayLike"),isObject=require("../lang/isObject"),shimKeys=require("../internal/shimKeys"),nativeKeys=getNative(Object,"keys"),keys=nativeKeys?function(e){var i=null==e?void 0:e.constructor;return"function"==typeof i&&i.prototype===e||"function"!=typeof e&&isArrayLike(e)?shimKeys(e):isObject(e)?nativeKeys(e):[]}:shimKeys;module.exports=keys;

},{"../internal/getNative":9,"../internal/isArrayLike":10,"../internal/shimKeys":15,"../lang/isObject":20}],23:[function(require,module,exports){
function keysIn(r){if(null==r)return[];isObject(r)||(r=Object(r));var e=r.length;e=e&&isLength(e)&&(isArray(r)||isArguments(r))&&e||0;for(var t=r.constructor,n=-1,s="function"==typeof t&&t.prototype===r,i=Array(e),o=e>0;++n<e;)i[n]=n+"";for(var a in r)o&&isIndex(a,e)||"constructor"==a&&(s||!hasOwnProperty.call(r,a))||i.push(a);return i}var isArguments=require("../lang/isArguments"),isArray=require("../lang/isArray"),isIndex=require("../internal/isIndex"),isLength=require("../internal/isLength"),isObject=require("../lang/isObject"),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;module.exports=keysIn;

},{"../internal/isIndex":11,"../internal/isLength":13,"../lang/isArguments":16,"../lang/isArray":17,"../lang/isObject":20}],24:[function(require,module,exports){
function identity(t){return t}module.exports=identity;

},{}],25:[function(require,module,exports){
"use strict";function CollisionBox(){this.x=-1,this.y=-1,this.w=2,this.h=2}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=CollisionBox;

},{}],26:[function(require,module,exports){
"use strict";function FallDeath(e){this.y=e,this.triggered=!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=FallDeath;

},{}],27:[function(require,module,exports){
"use strict";function Gravity(e){this.g=e}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Gravity;

},{}],28:[function(require,module,exports){
"use strict";function Platform(){}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Platform;

},{}],29:[function(require,module,exports){
"use strict";function PlatformStander(){this.grounded=!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=PlatformStander;

},{}],30:[function(require,module,exports){
"use strict";function Player(){}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Player;

},{}],31:[function(require,module,exports){
"use strict";function Position(){this.x=0,this.y=0,this.x_=0,this.y_=0}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Position;

},{}],32:[function(require,module,exports){
"use strict";function RenderBox(){this.x=-1,this.y=-1,this.w=2,this.h=2}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=RenderBox;

},{}],33:[function(require,module,exports){
"use strict";function Spider(){this.facing=1,this.webbing=!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Spider;

},{}],34:[function(require,module,exports){
"use strict";function Velocity(){this.x=0,this.y=0}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Velocity;

},{}],35:[function(require,module,exports){
"use strict";function Web(){this.t=0,this.x=0,this.y=0,this.dx=0,this.dy=0,this.hit=!1,this.hitLength=0,this.rate=400,this.ttl=.5}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Web;

},{}],36:[function(require,module,exports){
"use strict";var _initCanvas2=require("./lib/initCanvas"),_initCanvas3=babelHelpers.interopRequireDefault(_initCanvas2),_input=require("./input"),_input2=babelHelpers.interopRequireDefault(_input),_Demo=require("./scenes/Demo"),_Demo2=babelHelpers.interopRequireDefault(_Demo),_initCanvas=(0,_initCanvas3["default"])("#stage","2d",800,600),context=_initCanvas.context;_input2["default"].addEventListeners();var scene=new _Demo2["default"](context,_input2["default"]).load().start(),autoPause=function(e){document.hidden?scene.stop():scene.start()};window.addEventListener("visibilitychange",autoPause);

},{"./input":37,"./lib/initCanvas":50,"./scenes/Demo":51}],37:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Input=require("./lib/Input"),_Input2=babelHelpers.interopRequireDefault(_Input);exports["default"]=new _Input2["default"]({keys:{" ":"action",W:"jump",A:"left",S:"down",D:"right","&":"jump","%":"left","(":"down","'":"right"},axesFromKeys:[{axis:"x",defaultValue:0,names:["left","right"],values:[-1,1]}],gamepad:{buttons:[0,"jump",2,"action",12,"up",13,"down",14,"left",15,"right"],axes:[0,"x",1,"y"]}});

},{"./lib/Input":38}],38:[function(require,module,exports){
"use strict";function Input(e){var t=this;if(!e)throw new Error("No config was given.");if(this.codeToName={},this.nameToValue={},this.axisToValue={},this.nameToAxisFromKeys={},this.justPressedInputs=[],this.gamepadConfig=e.gamepad,e.keys){var s=e.keys;for(var n in s){var o=n.toUpperCase().charCodeAt(0),i=s[n];this.codeToName[o]=i,this.nameToValue[i]=!1}}if(e.axesFromKeys)for(var a=e.axesFromKeys,r=0,u=a.length;u>r;r++){var p=a[r];this.axisToValue[p.axis]=p.defaultValue,this.nameToAxisFromKeys[p.names[0]]=p,this.nameToAxisFromKeys[p.names[1]]=p}this.listenersAttached=!1,this.keydown=function(e){t._onkeydown(e)},this.keyup=function(e){t._onkeyup(e)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Input,Input.prototype.isPressed=function(e){return this.nameToValue[e]},Input.prototype.justPressed=function(e){return this.justPressedInputs.indexOf(e)>=0},Input.prototype.getAxis=function(e){return this.axisToValue[e]},Input.prototype.clearJustPressed=function(){this.justPressedInputs.length=0},Input.prototype.updateAxisFromKey=function(e){var t=this.nameToAxisFromKeys[e];if(t){var s=t.names,n=t.values;this.axisToValue[t.axis]=this.nameToValue[s[0]]?n[0]:this.nameToValue[s[1]]?n[1]:t.defaultValue}},Input.prototype.updateFromGamepad=function(e,t){var s=this.gamepadConfig.buttons;if(s)for(var n=0,o=s.length;o>n;n+=2){var i=s[n+1],a=t?t.buttons[s[n]]:s[n],r=e.buttons[a].pressed;r&&!this.nameToValue[i]&&this.justPressedInputs.push(i),this.nameToValue[i]=r}var u=this.gamepadConfig.axes;if(u)for(var n=0,o=u.length;o>n;n+=2){var p=t?t.axes[u[n]]:u[n];this.axisToValue[u[n+1]]=e.axes[p]}},Input.prototype.afterUpdate=function(){this.clearJustPressed()},Input.prototype._onkeydown=function(e){var t=e.keyCode,s=this.codeToName[t];s&&(this.nameToValue[s]||this.justPressedInputs.push(s),this.nameToValue[s]=!0,this.updateAxisFromKey(s))},Input.prototype._onkeyup=function(e){var t=e.keyCode,s=this.codeToName[t];s&&(this.nameToValue[s]=!1,this.updateAxisFromKey(s))},Input.prototype.addEventListeners=function(){return this.listenersAttached||(this.listenersAttached=!0,window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup)),this},Input.prototype.removeEventListeners=function(){return this.listenersAttached&&(this.listenersAttached=!1,window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup)),this};

},{}],39:[function(require,module,exports){
"use strict";function Loop(t,o,n){this.fn=t,this.thisArg=n,this.t0=0,this.running=!1,this.opts=o,this._loop=null,this.opts.useRAF||this.opts.interval||(this.opts.interval=1e3/60)}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Loop,Loop.prototype.start=function(){var t=this;if(!this.running)return this.running=!0,this.opts.useRAF?(this._loop=function(o){t.running&&(t.fn.call(t.thisArg,.001*(o-t.t0)),t.t0=o,window.requestAnimationFrame(t._loop))},window.requestAnimationFrame(function(o){t.t0=o,window.requestAnimationFrame(t._loop)})):(this._loop=function(){var o=Date.now();t.running&&(t.fn.call(t.thisArg,.001*(o-t.t0)),t.t0=o,window.setTimeout(t._loop,t.opts.interval))},this.t0=Date.now()-this.opts.interval,this._loop()),this},Loop.prototype.stop=function(){return this.running=!1,this},Loop.start=function(t,o,n){return new Loop(t,o,n).start()};

},{}],40:[function(require,module,exports){
"use strict";function componentMapFactory(e){var t=function(t){function r(){return babelHelpers.classCallCheck(this,r),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(r).call(this))}return babelHelpers.inherits(r,t),babelHelpers.createClass(r,[{key:"entities",value:function(){return new _EntitiesIterator.EntitiesIterator(this.keysValues,e)}},{key:"firstEntity",value:function(){if(0===this.size)throw new ReferenceError("Cannot retrieve the first entity from an empty map");var e=this.entities(),t=e.next();return t.value}},{key:"forEachEntity",value:function(e){for(var t=void 0,r=this.entities();!(t=r.next()).done;)e(t.value,this)}},{key:Symbol.iterator,value:function(){return new _EntitiesIterator.EntitiesIterator(this.keysValues,e)}}]),r}(_KeyMap2.KeyMap);return t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.componentMapFactory=componentMapFactory;var _KeyMap2=require("../repositories/KeyMap.js"),_EntitiesIterator=require("../iterators/EntitiesIterator.js");

},{"../iterators/EntitiesIterator.js":43,"../repositories/KeyMap.js":47}],41:[function(require,module,exports){
"use strict";function entityFactory(e){var t=function(){function t(e){babelHelpers.classCallCheck(this,t),this.key=e}return babelHelpers.createClass(t,[{key:"getComponent",value:function(t){return e.getComponent(this.key,t)}},{key:"getComponents",value:function(){for(var t=arguments.length,n=Array(t),o=0;t>o;o++)n[o]=arguments[o];return e.getComponents(this.key,n)}},{key:"hasComponent",value:function(t){return e.hasComponent(this.key,t)}},{key:"setComponent",value:function(t,n){return e.setComponent(this.key,t,n),this}},{key:"deleteComponent",value:function(t){return e.deleteComponent(this.key,t)}}]),t}();return t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.entityFactory=entityFactory;

},{}],42:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ecs=void 0;var _function=require("./polyfills/function.js"),functionPolyfill=babelHelpers.interopRequireWildcard(_function),_EntityService=require("./services/EntityService.js"),ecs=exports.ecs={EntityService:_EntityService.EntityService};if("undefined"!=typeof window)window.ecs=ecs;else if("undefined"!=typeof module&&null!==module)module.exports=ecs;else{var indirectEval=eval,globalThisArg=indirectEval("this");globalThisArg.ecs=ecs}

},{"./polyfills/function.js":46,"./services/EntityService.js":48}],43:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntitiesIterator=void 0;var _KeyMapIterators=require("../iterators/KeyMapIterators.js"),EntitiesIterator=exports.EntitiesIterator=function(){function t(e,r){babelHelpers.classCallCheck(this,t),this.iteratedNextIndex=0,this.iteratedObject=e,this.EntityClass=r}return babelHelpers.createClass(t,[{key:"next",value:function(){var t=this.superNext_(),e=t.done,r=void 0;return 0==e&&(r=new this.EntityClass(t.value)),{value:r,done:e}}},{key:Symbol.iterator,value:function(){return this}}]),t}();EntitiesIterator.prototype.superNext_=_KeyMapIterators.KeysIterator.prototype.next;

},{"../iterators/KeyMapIterators.js":44}],44:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var KeysIterator=exports.KeysIterator=function(){function e(t){babelHelpers.classCallCheck(this,e),this.iteratedNextIndex=0,this.iteratedObject=t}return babelHelpers.createClass(e,[{key:"next",value:function(){var e=this.iteratedNextIndex,t=this.iteratedObject.length,r=void 0,a=void 0;for(r=this.iteratedObject[e];(void 0===r||null===r)&&(e+=2)<t;)r=this.iteratedObject[e];return a=e>=t,this.iteratedNextIndex=e+2,{value:r,done:a}}},{key:Symbol.iterator,value:function(){return this}}]),e}(),EntriesIterator=exports.EntriesIterator=function(){function e(t){babelHelpers.classCallCheck(this,e),this.iteratedNextIndex=0,this.iteratedObject=t}return babelHelpers.createClass(e,[{key:"next",value:function(){var e=this.nextKey_(),t=e.done,r=void 0;return t===!1&&(r=[e.value,this.iteratedObject[this.iteratedNextIndex-1]]),{value:r,done:t}}},{key:Symbol.iterator,value:function(){return this}}]),e}();EntriesIterator.prototype.nextKey_=KeysIterator.prototype.next;var ValuesIterator=exports.ValuesIterator=function(){function e(t){babelHelpers.classCallCheck(this,e),this.iteratedNextIndex=0,this.iteratedObject=t}return babelHelpers.createClass(e,[{key:"next",value:function(){var e=this.nextKey_(),t=e.done,r=void 0;return t===!1&&(r=this.iteratedObject[this.iteratedNextIndex-1]),{value:r,done:t}}},{key:Symbol.iterator,value:function(){return this}}]),e}();ValuesIterator.prototype.nextKey_=KeysIterator.prototype.next;

},{}],45:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var NewEntityIdIterator=exports.NewEntityIdIterator=function(){function e(t){babelHelpers.classCallCheck(this,e),this.nextId=t}return babelHelpers.createClass(e,[{key:"next",value:function(){return{value:this.nextId++,done:!1}}},{key:Symbol.iterator,value:function(){return this}}]),e}();

},{}],46:[function(require,module,exports){
"use strict";function getFunctionName(n){var e=fnNameExp.exec(n.toString());return e?e[1]:void 0}function polyfillFunction(n){var e=n.Function;void 0===e.prototype.name&&Object.defineProperty(e.prototype,"name",{get:function(){var n=this.$__name;return void 0===n&&(n=this.$__name=getFunctionName(this)),n},configurable:!1,enumerable:!1})}var fnNameExp=/function ([^\(]+)/;polyfillFunction(self);

},{}],47:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyMap=void 0;var _KeyMapIterators=require("../iterators/KeyMapIterators.js"),queryifySync=void 0;"undefined"!==("undefined"==typeof queryify?"undefined":babelHelpers["typeof"](queryify))&&(queryifySync=queryify.sync);var KeyMap=exports.KeyMap=function(){function e(){babelHelpers.classCallCheck(this,e),this.clear()}return babelHelpers.createClass(e,null,[{key:"create",value:function(t,s,r){var a=new e;return a.keysValues=t,a.keysIndices_=s,a.valueCount_=r,a}},{key:"createFromIterator",value:function(t){for(var s=new e,r=s.keysIndices_,a=s.keysValues,u=0,n=void 0,i=void 0,y=void 0,o=t[Symbol.iterator]();!(y=o.next()).done;)n=y.value[0],i=y.value[1],r[n]=u,a.push(n),a.push(i),u+=2;return s.valueCount_=u/2,s}},{key:"createFromArray",value:function(t){return e.createFromIterator(new _KeyMapIterators.EntriesIterator(t))}},{key:"createFromJSON",value:function(t){var s=JSON.parse(t);return s.__proto__=e.prototype,s}}]),babelHelpers.createClass(e,[{key:"clear",value:function(){this.keysIndices_={},this.keysValues=[],this.valueCount_=0}},{key:"get",value:function(e){var t=this.keysIndices_[e];return this.keysValues[t+1]}},{key:"set",value:function(e,t){var s=this.keysIndices_[e];void 0===s?(s=this.keysValues.length,this.keysIndices_[e]=s,this.keysValues.push(e),this.keysValues.push(t),this.valueCount_++):this.keysValues[s+1]=t}},{key:"delete",value:function(e){var t=this.keysIndices_[e];return void 0===t?!1:(this.keysValues[t++]=void 0,this.keysValues[t]=void 0,this.keysIndices_[e]=void 0,this.valueCount_--,!0)}},{key:"has",value:function(e){return void 0!==this.keysIndices_[e]}},{key:"forEach",value:function(e){for(var t=0,s=void 0,r=void 0;t<this.keysValues.length;t+=2)s=this.keysValues[t],void 0!==s&&null!==s&&(r=this.keysValues[t+1],e(r,s,this))}},{key:"keys",value:function(){return new _KeyMapIterators.KeysIterator(this.keysValues)}},{key:"entries",value:function(){return new _KeyMapIterators.EntriesIterator(this.keysValues)}},{key:"values",value:function(){return new _KeyMapIterators.ValuesIterator(this.keysValues)}},{key:Symbol.iterator,value:function(){return new _KeyMapIterators.ValuesIterator(this.keysValues)}},{key:"queryValues",value:function(e){return queryifySync.filter(this,e)}},{key:"size",get:function(){return this.valueCount_}}]),e}();

},{"../iterators/KeyMapIterators.js":44}],48:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityService=void 0;var _EntityFactory=require("../factories/EntityFactory.js"),_ComponentMapFactory=require("../factories/ComponentMapFactory.js"),_KeyMap=require("../repositories/KeyMap.js"),_NewEntityIdIterator=require("../iterators/NewEntityIdIterator.js"),EntityService=exports.EntityService=function(){function e(){babelHelpers.classCallCheck(this,e),this.entityKeyIter_=new _NewEntityIdIterator.NewEntityIdIterator(1),this.Entity=(0,_EntityFactory.entityFactory)(this),this.ComponentMap=(0,_ComponentMapFactory.componentMapFactory)(this.Entity),this.componentMaps=new _KeyMap.KeyMap}return babelHelpers.createClass(e,null,[{key:"serialize",value:function(e){return JSON.stringify(e)}},{key:"createFromJSON",value:function(t){var n=JSON.parse(t),o=n.componentMaps,r=n.entityKeyIter_;r.__proto__=_NewEntityIdIterator.NewEntityIdIterator.prototype,n.__proto__=e.prototype,o.__proto__=_KeyMap.KeyMap.prototype,n.Entity=(0,_EntityFactory.entityFactory)(n),n.ComponentMap=(0,_ComponentMapFactory.componentMapFactory)(n.Entity);for(var a=n.ComponentMap.prototype,i=void 0,p=void 0,s=o.values();!(p=s.next()).done;)i=p.value,i.__proto__=a;return n}}]),babelHelpers.createClass(e,[{key:"registerComponent",value:function(e){var t=e.name;if(void 0===t)throw new ReferenceError("The component class name is not defined.");var n=new this.ComponentMap;return this.componentMaps.set(t,n),this}},{key:"nextEntityKey",value:function(){return this.entityKeyIter_.next().value}},{key:"createEntity",value:function(){return new this.Entity(this.nextEntityKey())}},{key:"deleteEntity",value:function(e){var t=0;return this.componentMaps.forEach(function(n){n.has(e)&&n["delete"](e)===!0&&t++}),t>0}},{key:"getComponentMap",value:function(e){return this.componentMaps.get(e.name)}},{key:"getComponent",value:function(e,t){var n=this.componentMaps.get(t.name);return n?n.get(e):void 0}},{key:"getComponents",value:function(e,t){for(var n=0,o=void 0,r=[];n<t.length;n++)o=this.componentMaps.get(t[n].name),r.push(o.get(e));return r}},{key:"hasComponent",value:function(e,t){return this.componentMaps.get(t.name).has(e)}},{key:"setComponent",value:function(e,t,n){var o=this.componentMaps.get(t.name);if(void 0===o)throw new ReferenceError("Component map does not exist.");return o.set(e,n),this}},{key:"deleteComponent",value:function(e,t){var n=this.componentMaps.get(t.name);if(void 0===n)throw new ReferenceError("Component map does not exist.");return n["delete"](e)}}]),e}();

},{"../factories/ComponentMapFactory.js":40,"../factories/EntityFactory.js":41,"../iterators/NewEntityIdIterator.js":45,"../repositories/KeyMap.js":47}],49:[function(require,module,exports){
"use strict";function mappingForGamepad(a){return""===a.mapping&&a.id.indexOf("Xbox One")>=0?mappings.XBOXONE.standard:null}Object.defineProperty(exports,"__esModule",{value:!0}),exports.mappingForGamepad=mappingForGamepad;var mappings={XBOXONE:{standard:{buttons:[11,12,13,14,8,9,-1,-1,5,4,6,7,0,1,2,3,10],axes:[0,1,3,4]}}};

},{}],50:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=function(e,t,n,r){var c=document.querySelector(e),o=document.createElement("canvas"),a=o.getContext(t);return o.width=n,o.height=r,c.appendChild(o),{canvas:o,context:a}};

},{}],51:[function(require,module,exports){
"use strict";function Demo(e,t){this.canvasContext=e,this.input=t,this.loop=new _Loop2["default"](this.tick,{useRAF:!0},this),this.running=!1,this.entityService=null,this.player=null,this.dt=0,this.updateSystems=[new _PlayerSpiderControlSystem2["default"],new _GravitySystem2["default"],new _SpiderWebSystem2["default"],new _VelocitySystem2["default"],new _PlatformSystem2["default"]],this.renderSystems=[new _ClearScreenSystem2["default"],new _SpiderWebRenderSystem2["default"],new _RenderBoxSystem2["default"]]}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Demo;var _assign=require("lodash/object/assign"),_assign2=babelHelpers.interopRequireDefault(_assign),_Loop=require("../lib/Loop"),_Loop2=babelHelpers.interopRequireDefault(_Loop),_ecs=require("../lib/ecs"),_gamepadMapper=require("../lib/gamepad-mapper"),_Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Velocity=require("../components/Velocity"),_Velocity2=babelHelpers.interopRequireDefault(_Velocity),_Gravity=require("../components/Gravity"),_Gravity2=babelHelpers.interopRequireDefault(_Gravity),_CollisionBox=require("../components/CollisionBox"),_CollisionBox2=babelHelpers.interopRequireDefault(_CollisionBox),_RenderBox=require("../components/RenderBox"),_RenderBox2=babelHelpers.interopRequireDefault(_RenderBox),_Platform=require("../components/Platform"),_Platform2=babelHelpers.interopRequireDefault(_Platform),_PlatformStander=require("../components/PlatformStander"),_PlatformStander2=babelHelpers.interopRequireDefault(_PlatformStander),_Player=require("../components/Player"),_Player2=babelHelpers.interopRequireDefault(_Player),_FallDeath=require("../components/FallDeath"),_FallDeath2=babelHelpers.interopRequireDefault(_FallDeath),_Spider=require("../components/Spider"),_Spider2=babelHelpers.interopRequireDefault(_Spider),_Web=require("../components/Web"),_Web2=babelHelpers.interopRequireDefault(_Web),_PlayerSpiderControlSystem=require("../systems/PlayerSpiderControlSystem"),_PlayerSpiderControlSystem2=babelHelpers.interopRequireDefault(_PlayerSpiderControlSystem),_GravitySystem=require("../systems/GravitySystem"),_GravitySystem2=babelHelpers.interopRequireDefault(_GravitySystem),_VelocitySystem=require("../systems/VelocitySystem"),_VelocitySystem2=babelHelpers.interopRequireDefault(_VelocitySystem),_ClearScreenSystem=require("../systems/ClearScreenSystem"),_ClearScreenSystem2=babelHelpers.interopRequireDefault(_ClearScreenSystem),_RenderBoxSystem=require("../systems/RenderBoxSystem"),_RenderBoxSystem2=babelHelpers.interopRequireDefault(_RenderBoxSystem),_PlatformSystem=require("../systems/PlatformSystem"),_PlatformSystem2=babelHelpers.interopRequireDefault(_PlatformSystem),_SpiderWebSystem=require("../systems/SpiderWebSystem"),_SpiderWebSystem2=babelHelpers.interopRequireDefault(_SpiderWebSystem),_SpiderWebRenderSystem=require("../systems/SpiderWebRenderSystem"),_SpiderWebRenderSystem2=babelHelpers.interopRequireDefault(_SpiderWebRenderSystem);Demo.prototype.load=function(){var e=this;this.entityService=new _ecs.ecs.EntityService,this.entityService.registerComponent(_Position2["default"]),this.entityService.registerComponent(_Velocity2["default"]),this.entityService.registerComponent(_Gravity2["default"]),this.entityService.registerComponent(_CollisionBox2["default"]),this.entityService.registerComponent(_RenderBox2["default"]),this.entityService.registerComponent(_Platform2["default"]),this.entityService.registerComponent(_PlatformStander2["default"]),this.entityService.registerComponent(_Player2["default"]),this.entityService.registerComponent(_FallDeath2["default"]),this.entityService.registerComponent(_Spider2["default"]),this.entityService.registerComponent(_Web2["default"]);var t=this.entityService.createEntity();return t.setComponent(_Position2["default"],(0,_assign2["default"])(new _Position2["default"],{x:150,y:250})),t.setComponent(_Velocity2["default"],(0,_assign2["default"])(new _Velocity2["default"],{x:1e3})),t.setComponent(_Gravity2["default"],new _Gravity2["default"](300)),t.setComponent(_CollisionBox2["default"],(0,_assign2["default"])(new _CollisionBox2["default"],{x:-10,y:-10,w:20,h:20})),t.setComponent(_RenderBox2["default"],(0,_assign2["default"])(new _RenderBox2["default"],{x:-10,y:-10,w:20,h:20})),t.setComponent(_PlatformStander2["default"],new _PlatformStander2["default"]),t.setComponent(_Player2["default"],new _Player2["default"]),t.setComponent(_FallDeath2["default"],new _FallDeath2["default"](this.canvasContext.canvas.height)),t.setComponent(_Spider2["default"],new _Spider2["default"]),t.setComponent(_Web2["default"],new _Web2["default"]),this.player=t,[{x:50,y:400,vx:50},{x:150,y:450},{x:250,y:400},{x:350,y:350},{x:550,y:350},{x:650,y:300},{x:700,y:250},{x:650,y:200},{x:425,y:100,w:80},{x:300,y:200,w:100}].forEach(function(t){var r=t.w||50,i=t.h||6,o=new _Position2["default"];o.x=t.x,o.y=t.y;var n=new _CollisionBox2["default"],a=new _RenderBox2["default"];n.x=a.x=-r/2,n.y=a.y=-i/2,n.w=a.w=r,n.h=a.h=i;var s=new _Platform2["default"],l=e.entityService.createEntity();l.setComponent(_Position2["default"],o),l.setComponent(_CollisionBox2["default"],n),l.setComponent(_RenderBox2["default"],a),l.setComponent(_Platform2["default"],s)}),this},Demo.prototype.tick=function(e){this.dt=Math.min(e,.04);var t=this.updateSystems,r=this.renderSystems;if(this.player.getComponent(_FallDeath2["default"]).triggered)return void this.load();var i=navigator.getGamepads&&navigator.getGamepads()[0];i&&this.input.updateFromGamepad(i,(0,_gamepadMapper.mappingForGamepad)(i));for(var o=0,n=t.length;n>o;o++)t[o].run(this);this.input.afterUpdate();for(var o=0,n=r.length;n>o;o++)r[o].run(this)},Demo.prototype.start=function(){return this.running?void 0:(this.running=!0,this.loop.start(),this)},Demo.prototype.stop=function(){return this.running?(this.running=!1,this.loop.stop(),this):void 0},Demo.prototype.unload=function(){return this.stop(),this.loop=null,this};

},{"../components/CollisionBox":25,"../components/FallDeath":26,"../components/Gravity":27,"../components/Platform":28,"../components/PlatformStander":29,"../components/Player":30,"../components/Position":31,"../components/RenderBox":32,"../components/Spider":33,"../components/Velocity":34,"../components/Web":35,"../lib/Loop":39,"../lib/ecs":42,"../lib/gamepad-mapper":49,"../systems/ClearScreenSystem":52,"../systems/GravitySystem":53,"../systems/PlatformSystem":54,"../systems/PlayerSpiderControlSystem":55,"../systems/RenderBoxSystem":56,"../systems/SpiderWebRenderSystem":57,"../systems/SpiderWebSystem":58,"../systems/VelocitySystem":59,"lodash/object/assign":21}],52:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ClearScreenSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){var a=e.canvasContext;a.clearRect(0,0,a.canvas.width,a.canvas.height)}}]),e}();exports["default"]=ClearScreenSystem;

},{}],53:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Gravity=require("../components/Gravity"),_Gravity2=babelHelpers.interopRequireDefault(_Gravity),_Velocity=require("../components/Velocity"),_Velocity2=babelHelpers.interopRequireDefault(_Velocity),GravitySystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){var t=e.dt,r=e.entityService.getComponentMap(_Gravity2["default"]),a=!0,i=!1,l=void 0;try{for(var o,n=r[Symbol.iterator]();!(a=(o=n.next()).done);a=!0){var y=o.value,u=y.getComponent(_Velocity2["default"]),c=y.getComponent(_Gravity2["default"]);u.y+=c.g*t}}catch(s){i=!0,l=s}finally{try{!a&&n["return"]&&n["return"]()}finally{if(i)throw l}}}}]),e}();exports["default"]=GravitySystem;

},{"../components/Gravity":27,"../components/Velocity":34}],54:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Velocity=require("../components/Velocity"),_Velocity2=babelHelpers.interopRequireDefault(_Velocity),_CollisionBox=require("../components/CollisionBox"),_CollisionBox2=babelHelpers.interopRequireDefault(_CollisionBox),_Platform=require("../components/Platform"),_Platform2=babelHelpers.interopRequireDefault(_Platform),_PlatformStander=require("../components/PlatformStander"),_PlatformStander2=babelHelpers.interopRequireDefault(_PlatformStander),PlatformSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){var t=e.entityService.getComponentMap(_Platform2["default"]),o=e.entityService.getComponentMap(_PlatformStander2["default"]),r=!0,l=!1,n=void 0;try{for(var a,i=o[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var u=a.value,f=u.getComponent(_CollisionBox2["default"]),y=u.getComponent(_Position2["default"]),s=u.getComponent(_Velocity2["default"]),m=u.getComponent(_PlatformStander2["default"]),p=!1,_=!0,c=!1,d=void 0;try{for(var x,P=t[Symbol.iterator]();!(_=(x=P.next()).done);_=!0){var C=x.value,b=C.getComponent(_CollisionBox2["default"]),v=C.getComponent(_Position2["default"]),S=C.getComponent(_Velocity2["default"]);y.x+f.x+f.w>v.x+b.x&&y.x+f.x<v.x+b.x+b.w&&y.y+f.y+f.h>v.y+b.y&&y.y+f.y<v.y+b.y+b.h&&y.y_+f.y+f.h<=v.y+b.y&&(p=!0,y.y=v.y+b.y-f.y-f.h,s.y=0,S&&(s.x+=S.x))}}catch(g){c=!0,d=g}finally{try{!_&&P["return"]&&P["return"]()}finally{if(c)throw d}}m.grounded=p}}catch(g){l=!0,n=g}finally{try{!r&&i["return"]&&i["return"]()}finally{if(l)throw n}}}}]),e}();exports["default"]=PlatformSystem;

},{"../components/CollisionBox":25,"../components/Platform":28,"../components/PlatformStander":29,"../components/Position":31,"../components/Velocity":34}],55:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Player=require("../components/Player"),_Player2=babelHelpers.interopRequireDefault(_Player),_Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Velocity=require("../components/Velocity"),_Velocity2=babelHelpers.interopRequireDefault(_Velocity),_FallDeath=require("../components/FallDeath"),_FallDeath2=babelHelpers.interopRequireDefault(_FallDeath),_Spider=require("../components/Spider"),_Spider2=babelHelpers.interopRequireDefault(_Spider),_Web=require("../components/Web"),_Web2=babelHelpers.interopRequireDefault(_Web),_PlatformStander=require("../components/PlatformStander"),_PlatformStander2=babelHelpers.interopRequireDefault(_PlatformStander),PlayerSpiderControlSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){var t=e.dt,r=e.entityService.getComponentMap(_Player2["default"]).firstEntity(),a=e.input,n=r.getComponent(_Position2["default"]),i=r.getComponent(_Velocity2["default"]),l=r.getComponent(_FallDeath2["default"]),o=r.getComponent(_Spider2["default"]),s=r.getComponent(_Web2["default"]),u=r.getComponent(_PlatformStander2["default"]).grounded,p=a.getAxis("x"),b=.1;if(o.webbing&&s.hit)(u||a.justPressed("jump")||a.justPressed("action"))&&(o.webbing=!1);else{var d=u?2e3:1e3,_=u?15:2,f=150*p;u&&a.justPressed("jump")&&(i.y=-200),-b>p?(i.x>f&&(i.x=Math.max(i.x-d*t,f)),o.facing=-1):p>b?(i.x<f&&(i.x=Math.min(i.x+d*t,f)),o.facing=1):i.x*=Math.max(1-_*t,0),!o.webbing&&a.justPressed("action")&&(o.webbing=!0,s.t=0,s.x=n.x,s.y=n.y,s.dx=o.facing*Math.sqrt(.5),s.dy=-Math.sqrt(.5),s.hit=!1)}n.y>l.y&&(l.triggered=!0,o.webbing=!1)}}]),e}();exports["default"]=PlayerSpiderControlSystem;

},{"../components/FallDeath":26,"../components/PlatformStander":29,"../components/Player":30,"../components/Position":31,"../components/Spider":33,"../components/Velocity":34,"../components/Web":35}],56:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_RenderBox=require("../components/RenderBox"),_RenderBox2=babelHelpers.interopRequireDefault(_RenderBox),RenderBoxSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){var t=e.canvasContext,r=e.entityService.getComponentMap(_RenderBox2["default"]);t.fillStyle="#fff";var o=!0,n=!1,l=void 0;try{for(var i,a=r[Symbol.iterator]();!(o=(i=a.next()).done);o=!0){var s=i.value,u=s.getComponent(_Position2["default"]),f=s.getComponent(_RenderBox2["default"]);t.fillRect(u.x+f.x|0,u.y+f.y|0,f.w,f.h)}}catch(d){n=!0,l=d}finally{try{!o&&a["return"]&&a["return"]()}finally{if(n)throw l}}}}]),e}();exports["default"]=RenderBoxSystem;

},{"../components/Position":31,"../components/RenderBox":32}],57:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Spider=require("../components/Spider"),_Spider2=babelHelpers.interopRequireDefault(_Spider),_Web=require("../components/Web"),_Web2=babelHelpers.interopRequireDefault(_Web),SpiderWebSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){var t=e.canvasContext,r=e.entityService.getComponentMap(_Web2["default"]);t.strokeStyle="#fff",t.lineWidth=2;var o=!0,i=!1,n=void 0;try{for(var a,l=r[Symbol.iterator]();!(o=(a=l.next()).done);o=!0){var s=a.value,p=s.getComponent(_Spider2["default"]),u=s.getComponent(_Position2["default"]);if(p.webbing){var b=s.getComponent(_Web2["default"]);t.beginPath(),t.moveTo(u.x,u.y),t.lineTo(b.x,b.y),t.stroke()}}}catch(f){i=!0,n=f}finally{try{!o&&l["return"]&&l["return"]()}finally{if(i)throw n}}}}]),e}();exports["default"]=SpiderWebSystem;

},{"../components/Position":31,"../components/Spider":33,"../components/Web":35}],58:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Velocity=require("../components/Velocity"),_Velocity2=babelHelpers.interopRequireDefault(_Velocity),_Spider=require("../components/Spider"),_Spider2=babelHelpers.interopRequireDefault(_Spider),_Web=require("../components/Web"),_Web2=babelHelpers.interopRequireDefault(_Web),_Platform=require("../components/Platform"),_Platform2=babelHelpers.interopRequireDefault(_Platform),_CollisionBox=require("../components/CollisionBox"),_CollisionBox2=babelHelpers.interopRequireDefault(_CollisionBox),SpiderWebSystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){var t=e.dt,o=e.entityService.getComponentMap(_Web2["default"]),r=!0,i=!1,l=void 0;try{for(var n,a=o[Symbol.iterator]();!(r=(n=a.next()).done);r=!0){var u=n.value,s=u.getComponent(_Spider2["default"]),p=u.getComponent(_Position2["default"]);if(s.webbing){var y=u.getComponent(_Web2["default"]),f=u.getComponent(_Velocity2["default"]);if(y.hit){var b=p.x-y.x,_=p.y-y.y,c=y.hitLength,d=-_/c,x=b/c,m=d*f.x+x*f.y,v=m*b,C=b+d*v,h=_+x*v,q=c/Math.sqrt(C*C+h*h),S=y.x+C*q,g=y.y+h*q;f.x=(S-p.x)/t,f.y=(g-p.y)/t}else if(y.t>y.ttl)s.webbing=!1;else{y.x+=y.dx*y.rate*t,y.y+=y.dy*y.rate*t,y.t+=t;var P=e.entityService.getComponentMap(_Platform2["default"]),H=!0,W=!1,D=void 0;try{for(var R,w=P[Symbol.iterator]();!(H=(R=w.next()).done);H=!0){var B=R.value,M=B.getComponent(_Position2["default"]),V=B.getComponent(_CollisionBox2["default"]);if(y.x>M.x+V.x&&y.x<M.x+V.x+V.w&&y.y>M.y+V.y&&y.y<M.y+V.y+V.h){var b=p.x-y.x,_=p.y-y.y;y.hitLength=Math.sqrt(b*b+_*_),y.hit=!0;break}}}catch(k){W=!0,D=k}finally{try{!H&&w["return"]&&w["return"]()}finally{if(W)throw D}}}}}}catch(k){i=!0,l=k}finally{try{!r&&a["return"]&&a["return"]()}finally{if(i)throw l}}}}]),e}();exports["default"]=SpiderWebSystem;

},{"../components/CollisionBox":25,"../components/Platform":28,"../components/Position":31,"../components/Spider":33,"../components/Velocity":34,"../components/Web":35}],59:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Position=require("../components/Position"),_Position2=babelHelpers.interopRequireDefault(_Position),_Velocity=require("../components/Velocity"),_Velocity2=babelHelpers.interopRequireDefault(_Velocity),VelocitySystem=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"run",value:function(e){var t=e.dt,o=e.entityService.getComponentMap(_Velocity2["default"]),i=!0,r=!1,l=void 0;try{for(var n,a=o[Symbol.iterator]();!(i=(n=a.next()).done);i=!0){var s=n.value,u=s.getComponent(_Position2["default"]),y=s.getComponent(_Velocity2["default"]);u.x_=u.x,u.y_=u.y,u.x+=y.x*t,u.y+=y.y*t}}catch(c){r=!0,l=c}finally{try{!i&&a["return"]&&a["return"]()}finally{if(r)throw l}}}}]),e}();exports["default"]=VelocitySystem;

},{"../components/Position":31,"../components/Velocity":34}]},{},[36]);
